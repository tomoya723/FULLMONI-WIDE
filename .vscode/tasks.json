{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build (GCC-RX)",
            "type": "shell",
            "command": "C:/Renesas/e2_studio/eclipse/plugins/com.renesas.ide.exttools.gnumake.win32.x86_64_4.3.1.v20240909-0854/mk/make.exe",
            "args": [
                "-j8",
                "all"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Firmware/HardwareDebug"
            },
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$gcc"
            ],
            "detail": "GCC-RX用のビルドタスク (Renesas RX マイコン)"
        },
        {
            "label": "Clean (GCC-RX)",
            "type": "shell",
            "command": "C:/Renesas/e2_studio/eclipse/plugins/com.renesas.ide.exttools.gnumake.win32.x86_64_4.3.1.v20240909-0854/mk/make.exe",
            "args": [
                "clean"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Firmware/HardwareDebug"
            },
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "detail": "ビルド成果物をクリーンアップ"
        },
        {
            "label": "Rebuild (GCC-RX)",
            "type": "shell",
            "dependsOn": [
                "Clean (GCC-RX)",
                "Build (GCC-RX)"
            ],
            "dependsOrder": "sequence",
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "detail": "クリーンしてから完全ビルドを実行"
        },
        {
            "label": "Size Info (GCC-RX)",
            "type": "shell",
            "command": "rx-elf-size",
            "args": [
                "--format=berkeley",
                "Firmware.elf"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Firmware/HardwareDebug"
            },
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "detail": "ビルド結果のメモリサイズ情報を表示"
        },
        {
            "label": "Generate compile_commands.json",
            "type": "shell",
            "command": "C:/Renesas/e2_studio/eclipse/plugins/com.renesas.ide.exttools.gnumake.win32.x86_64_4.3.1.v20240909-0854/mk/make.exe",
            "args": [
                "-B",
                "-n",
                "all",
                "|",
                "grep",
                "-E",
                "\"^rx-elf-gcc\"",
                ">",
                "compile_flags.txt"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Firmware/HardwareDebug",
                "shell": {
                    "executable": "powershell.exe",
                    "args": [
                        "-c"
                    ]
                }
            },
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "silent",
                "focus": false,
                "panel": "shared"
            },
            "detail": "IntelliSense用のcompile_commands.json生成"
        },
        {
            "label": "Build Bootloader (GCC-RX)",
            "type": "shell",
            "command": "C:/Renesas/e2_studio/eclipse/plugins/com.renesas.ide.exttools.gnumake.win32.x86_64_4.3.1.v20240909-0854/mk/make.exe",
            "args": [
                "-j8",
                "all"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Bootloader/HardwareDebug"
            },
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            },
            "problemMatcher": [
                "$gcc"
            ],
            "detail": "Bootloaderプロジェクトのビルド"
        },
        {
            "label": "Clean Bootloader (GCC-RX)",
            "type": "shell",
            "command": "C:/Renesas/e2_studio/eclipse/plugins/com.renesas.ide.exttools.gnumake.win32.x86_64_4.3.1.v20240909-0854/mk/make.exe",
            "args": [
                "clean"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Bootloader/HardwareDebug"
            },
            "group": "build",
            "detail": "Bootloaderのビルド成果物をクリーンアップ"
        },
        {
            "label": "RAM Usage Detail (GCC-RX)",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-ExecutionPolicy", "Bypass",
                "-File", "${workspaceFolder}/tools/check_ram_usage.ps1",
                "-MapFile", "Firmware.map"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Firmware/HardwareDebug"
            },
            "group": "build",
            "presentation": {
                "echo": false,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "detail": "mapファイルから正確なRAM使用量を計算して表示（rx-elf-sizeより正確）"
        },
        {
            "label": "Generate Firmware_noofs.mot",
            "type": "shell",
            "command": "rx-elf-objcopy",
            "args": [
                "Firmware.elf",
                "-O", "srec",
                "-I", "elf32-rx-be-ns",
                "--remove-section=.ofs1",
                "--remove-section=.ofs2",
                "--remove-section=.ofs3",
                "--remove-section=.ofs4",
                "--remove-section=.ofs5",
                "--remove-section=.ofs6",
                "--remove-section=.ofs7",
                "--remove-section=.ofs8",
                "--remove-section=.exvectors",
                "Firmware_noofs.mot"
            ],
            "options": {
                "cwd": "${workspaceFolder}/Firmware/HardwareDebug"
            },
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "silent",
                "focus": false,
                "panel": "shared"
            },
            "detail": "Bootloaderと衝突しないMOTファイルを生成（Renesas Flash Programmer用）"
        },
        {
            "label": "Build + Generate MOT (GCC-RX)",
            "dependsOn": [
                "Build (GCC-RX)",
                "Generate Firmware_noofs.mot"
            ],
            "dependsOrder": "sequence",
            "group": "build",
            "detail": "ビルド後にFirmware_noofs.motを自動生成"
        }
    ]
}
